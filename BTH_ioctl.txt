BtConnectionManagerService.dll
0x410000 IOCTL_BTH_GET_LOCAL_INFO                in BTH_LOCAL_RADIO_INFO, out BTH_LOCAL_RADIO_INFO
0x410008 IOCTL_BTH_GET_DEVICE_INFO
0x41000c IOCTL_BTH_DISCONNECT_DEVICE
0x4100d8 IOCTL_BTH_DISCONNECT_DEVICE_EX
0x4100e4 IOCTL_BTH_LE_ENTER_ACTIVE_SCANNING
0x410200 IOCTL_BTH_SDP_CONNECT
0x410204 IOCTL_BTH_SDP_DISCONNECT
0x410210 IOCTL_BTH_SDP_SERVICE_ATTRIBUTE_SEARCH
0x410214 IOCTL_BTH_SDP_SUBMIT_RECORD
0x410218 IOCTL_BTH_SDP_REMOVE_RECORD
0x41021c IOCTL_BTH_SDP_SUBMIT_RECORD_WITH_INFO
0x411000 IOCTL_BTH_INQUIRY_DEVICE
0x411004 IOCTL_BTH_AUTH_RESPONSE                  in BTH_AUTHENTICATE_RESPONSE, out BTHSTATUS
0x411008 IOCTL_BTH_UPDATE_SETTINGS
0x41100c IOCTL_BTH_PERSONALIZE_DEVICE
0x411010 IOCTL_BTH_PAIR_DEVICE                		in BTH_AUTHENTICATE_DEVICE, out BTHSTATUS
0x411014 IOCTL_BTH_UNPAIR_DEVICE
0x411018 IOCTL_BTH_QUERY_UNPAIR_DEVICE
0x411020 IOCTL_BTH_SCAN_ENABLE
0x411030 IOCTL_BTH_UPDATE_DEVICE
0x411038 IOCTL_BTH_GET_DEVICE_PROTOCOLS_INFO
0x41104c IOCTL_BTH_SET_LOCAL_SERVICE_INFO
0x411058 IOCTL_BTH_GET_DEVICE_INFO_EX
0x41110c IOCTL_BTH_UNPAIR_DEVICE_EX
0x411cc4 IOCTL_BTH_WP8_ALLOW_INCOMING_SCO
0x411cc8 IOCTL_BTH_WP8_FORBID_INCOMING_SCO
0x411ccc IOCTL_BTH_WP8_CONNECT_SCO
0x411cd0 IOCTL_BTH_WP8_DISCONNECT_SCO
0x411d00 IOCTL_BTH_WP8_L2CAP_REGISTER
0x411d04 IOCTL_BTH_WP8_L2CAP_UNREGISTER
0x411d08 IOCTL_BTH_WP8_L2CAP_LISTEN
0x411d0c IOCTL_BTH_WP8_L2CAP_CONNECT
0x411d10 IOCTL_BTH_WP8_L2CAP_ATTACH
0x411d14 IOCTL_BTH_WP8_L2CAP_DISPOSE
0x414010 IOCTL_BTHLEENUM_READ_GATT_EVENT
0x414014 IOCTL_BTHLEENUM_READ_QUEUE_ACTIVATE

bthl2cap.sys
0x220003 IOCTL_BTHHFP_GET_DEVICEOBJECT
0x220007 IOCTL_BTHHFP_DEVICE_GET_KSNODETYPES
0x22000b IOCTL_BTHHFP_DEVICE_GET_CONTAINERID
0x22000f IOCTL_BTHHFP_DEVICE_REQUEST_CONNECT
0x220013 IOCTL_BTHHFP_DEVICE_REQUEST_DISCONNECT
0x220017 IOCTL_BTHHFP_DEVICE_GET_CONNECTION_STATUS_UPDATE
0x22001b IOCTL_BTHHFP_SPEAKER_SET_VOLUME
0x22001f IOCTL_BTHHFP_SPEAKER_GET_VOLUME_STATUS_UPDATE
0x220023 IOCTL_BTHHFP_MIC_SET_VOLUME
0x220027 IOCTL_BTHHFP_MIC_GET_VOLUME_STATUS_UPDATE
0x22002b IOCTL_BTHHFP_STREAM_OPEN
0x22002f IOCTL_BTHHFP_STREAM_CLOSE
0x220033 IOCTL_BTHHFP_STREAM_GET_STATUS_UPDATE
0x22003c IOCTL_BTHHFP_DEVICE_GET_CODEC_ID
0x220193 IOCTL_BTHHFP_DEVICE_GET_DESCRIPTOR
0x220197 IOCTL_BTHHFP_DEVICE_GET_VOLUMEPROPERTYVALUES
0x410007 IOCTL_INTERNAL_BTHENUM_GET_enumInfo
0x411cc0 IOCTL_BTH_WP8_INITIALIZE_AUDIO_DEVICE
0x411cc4 IOCTL_BTH_WP8_ALLOW_INCOMING_SCO
0x411cc8 IOCTL_BTH_WP8_FORBID_INCOMING_SCO
0x411ccc IOCTL_BTH_WP8_CONNECT_SCO
0x411cd0 IOCTL_BTH_WP8_DISCONNECT_SCO
0x411cd4 IOCTL_BTH_WP8_SET_AUDIO_CONNECTED
0x411cd8 IOCTL_BTH_WP8_SET_AUDIO_DISCONNECTED
0x411cdc IOCTL_BTH_WP8_CHANGE_SPEAKER_VOLUME
0x411ce0 IOCTL_BTH_WP8_CHANGE_MICROPHONE_VOLUME
0x411ce4 IOCTL_BTH_WP8_GET_AUDIO_INDICATION
0x411ce8 IOCTL_BTH_WP8_SET_CODEC_ID

bthmini.sys
0x410403 IOCTL_BTHX_GET_VERSION
0x410407 IOCTL_BTHX_SET_VERSION
0x41040b IOCTL_BTHX_QUERY_CAPABILITIES

// Structurs

#define BTH_MAX_NAME_SIZE          (248)
typedef ULONGLONG BTH_ADDR, *PBTH_ADDR;
typedef ULONG BTH_COD, *PBTH_COD;

#pragma pack(8)
typedef struct _BTH_DEVICE_INFO {
	ULONG flags;
	BTH_ADDR address;
	BTH_COD classOfDevice;
	CHAR name[BTH_MAX_NAME_SIZE];
} BTH_DEVICE_INFO, *PBTH_DEVICE_INFO;
#pragma pack(1)
typedef struct _BTH_RADIO_INFO {
	ULONGLONG lmpSupportedFeatures;
	USHORT mfg;
	USHORT lmpSubversion;
	UCHAR lmpVersion;
} BTH_RADIO_INFO, *PBTH_RADIO_INFO;
typedef struct _BTH_LOCAL_RADIO_INFO {
	BTH_DEVICE_INFO localInfo;
	ULONG           flags;
	USHORT          hciRevision;
	UCHAR           hciVersion;
	BTH_RADIO_INFO  radioInfo;
} BTH_LOCAL_RADIO_INFO, *PBTH_LOCAL_RADIO_INFO;
#pragma pack(8)

typedef struct _BTH_AUTHENTICATE_DEVICE {
	ULONG unknown1;  // 0x4000
	BTH_ADDR address; // 0xE0E751333260
	UCHAR unknown2[560];
	ULONG unknown3;  // 0x3 0x0...0x5
	ULONG unknown4;
	ULONG unknown5;
	ULONG unknown6;
} BTH_AUTHENTICATE_DEVICE, *PBTH_AUTHENTICATE_DEVICE;

typedef UCHAR BTHSTATUS;

#define BTH_MAX_PIN_SIZE            (16)

typedef struct _BTH_PIN_INFO {
	UCHAR pin[BTH_MAX_PIN_SIZE];  // 1234
	UCHAR pinLength;              // 4
} BTH_PIN_INFO, *PBTH_PIN_INFO;

typedef struct _BTH_AUTHENTICATE_RESPONSE {
	ULONG unknown1;  // 0x4000
	BTH_ADDR address;  // 0xE0E751333260
	UCHAR unknown2[520];
	ULONG unknown3;  // 0x01
	BTH_PIN_INFO info;
	ULONG unknown4;
	ULONG unknown5;
	ULONG unknown6;
	ULONG unknown7;
} BTH_AUTHENTICATE_RESPONSE, *PBTH_AUTHENTICATE_RESPONSE;

// BTHSTATUS values:
#define BTH_ERROR_SUCCESS                           (0x00)
#define BTH_ERROR_UNKNOWN_HCI_COMMAND               (0x01)
#define BTH_ERROR_NO_CONNECTION                     (0x02)
#define BTH_ERROR_HARDWARE_FAILURE                  (0x03)
#define BTH_ERROR_PAGE_TIMEOUT                      (0x04)
#define BTH_ERROR_AUTHENTICATION_FAILURE            (0x05)
#define BTH_ERROR_KEY_MISSING                       (0x06)
#define BTH_ERROR_MEMORY_FULL                       (0x07)
#define BTH_ERROR_CONNECTION_TIMEOUT                (0x08)
#define BTH_ERROR_MAX_NUMBER_OF_CONNECTIONS         (0x09)
#define BTH_ERROR_MAX_NUMBER_OF_SCO_CONNECTIONS     (0x0a)
#define BTH_ERROR_ACL_CONNECTION_ALREADY_EXISTS     (0x0b)
#define BTH_ERROR_COMMAND_DISALLOWED                (0x0c)
#define BTH_ERROR_HOST_REJECTED_LIMITED_RESOURCES   (0x0d)
#define BTH_ERROR_HOST_REJECTED_SECURITY_REASONS    (0x0e)
#define BTH_ERROR_HOST_REJECTED_PERSONAL_DEVICE     (0x0f)
#define BTH_ERROR_HOST_TIMEOUT                      (0x10)
#define BTH_ERROR_UNSUPPORTED_FEATURE_OR_PARAMETER  (0x11)
#define BTH_ERROR_INVALID_HCI_PARAMETER             (0x12)
#define BTH_ERROR_REMOTE_USER_ENDED_CONNECTION      (0x13)
#define BTH_ERROR_REMOTE_LOW_RESOURCES              (0x14)
#define BTH_ERROR_REMOTE_POWERING_OFF               (0x15)
#define BTH_ERROR_LOCAL_HOST_TERMINATED_CONNECTION  (0x16)
#define BTH_ERROR_REPEATED_ATTEMPTS                 (0x17)
#define BTH_ERROR_PAIRING_NOT_ALLOWED               (0x18)
#define BTH_ERROR_UKNOWN_LMP_PDU                    (0x19)
#define BTH_ERROR_UNSUPPORTED_REMOTE_FEATURE        (0x1a)
#define BTH_ERROR_SCO_OFFSET_REJECTED               (0x1b)
#define BTH_ERROR_SCO_INTERVAL_REJECTED             (0x1c)
#define BTH_ERROR_SCO_AIRMODE_REJECTED              (0x1d)
#define BTH_ERROR_INVALID_LMP_PARAMETERS            (0x1e)
#define BTH_ERROR_UNSPECIFIED_ERROR                 (0x1f)
#define BTH_ERROR_UNSUPPORTED_LMP_PARM_VALUE        (0x20)
#define BTH_ERROR_ROLE_CHANGE_NOT_ALLOWED           (0x21)
#define BTH_ERROR_LMP_RESPONSE_TIMEOUT              (0x22)
#define BTH_ERROR_LMP_TRANSACTION_COLLISION         (0x23)
#define BTH_ERROR_LMP_PDU_NOT_ALLOWED               (0x24)
#define BTH_ERROR_ENCRYPTION_MODE_NOT_ACCEPTABLE    (0x25)
#define BTH_ERROR_UNIT_KEY_NOT_USED                 (0x26)
#define BTH_ERROR_QOS_IS_NOT_SUPPORTED              (0x27)
#define BTH_ERROR_INSTANT_PASSED                    (0x28)
#define BTH_ERROR_PAIRING_WITH_UNIT_KEY_NOT_SUPPORTED (0x29)
#define BTH_ERROR_UNSPECIFIED                       (0xFF)
